import{q as y,a as s,x as j,p as e,y as m}from"./chunk-UIGDSWPH-CtiJzZl8.js";import{i as f}from"./gameID-tORuqkkw.js";async function S(){try{const a="wss://turn-tracker-backend.fly.dev/ws".replace(/^wss?:\/\//,"https://").replace(/\/ws$/,"/health");if(!(await fetch(a,{method:"GET",cache:"no-cache",signal:AbortSignal.timeout(5e3)})).ok)throw new Response("Backend unavailable",{status:503,statusText:"Service Unavailable"})}catch(d){throw console.error("Home: Backend unavailable:",d),new Response(null,{status:302,headers:{Location:"/offline"}})}return{}}const T=y(function(){const[a,c]=s.useState(""),x=j(),p=new URLSearchParams(x.search).get("code"),[o,u]=s.useState(null),[b,h]=s.useState(!1);s.useEffect(()=>{if(p){const t=p.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,4);c(t)}},[p]),s.useEffect(()=>{(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://"))&&h(!0);const r=i=>{i.preventDefault(),u(i)},n=()=>{h(!0),u(null)};return window.addEventListener("beforeinstallprompt",r),window.addEventListener("appinstalled",n),()=>{window.removeEventListener("beforeinstallprompt",r),window.removeEventListener("appinstalled",n)}},[]);const v=t=>{const i=t.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,4);c(i)},w=t=>{if(!f(a))return t.preventDefault(),!1},g=async()=>{if(!o){const t=/iPad|iPhone|iPod/.test(navigator.userAgent),r=/Android/.test(navigator.userAgent);alert(t?`To install on iOS:

1. Tap the Share button (square with arrow)
2. Scroll down and tap "Add to Home Screen"
3. Tap "Add"`:r?`To install on Android:

1. Tap the Menu (⋮) in your browser
2. Tap "Add to Home screen" or "Install app"
3. Tap "Add" or "Install"`:`To install this app:

Look for the install button in your browser's address bar,
or use your browser's menu to find "Install" or "Add to Home Screen"`);return}try{await o.prompt();const{outcome:t}=await o.userChoice;t==="accepted"&&(u(null),h(!0))}catch(t){console.error("Error showing install prompt:",t);const r=/iPad|iPhone|iPod/.test(navigator.userAgent),n=/Android/.test(navigator.userAgent);r?alert(`To install on iOS:

1. Tap the Share button (square with arrow)
2. Scroll down and tap "Add to Home Screen"
3. Tap "Add"`):n&&alert(`To install on Android:

1. Tap the Menu (⋮) in your browser
2. Tap "Add to Home screen" or "Install app"
3. Tap "Add" or "Install"`)}},l=f(a);return e.jsx("div",{children:e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center h-screen text-center space-y-8 p-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("h1",{className:"text-6xl font-bold text-transparent bg-clip-text bg-linear-to-r from-blue-400 via-cyan-300 to-purple-400",children:"Turn Tracker"})}),e.jsx("div",{className:"space-y-6",children:e.jsx(m,{to:"/game/",end:!0,children:e.jsx("button",{className:"relative bg-linear-to-r from-blue-600 to-cyan-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-blue-700/50 hover:to-cyan-700/50 transition-all",children:e.jsx("div",{className:"relative flex items-center space-x-2",children:e.jsx("span",{children:"Start New Game"})})})})}),e.jsx("div",{className:"bg-slate-800/30 backdrop-blur-sm border border-slate-700/50 rounded-xl p-6 space-y-4",children:e.jsx("div",{className:"flex space-y-2",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("input",{type:"text",value:a,onChange:v,placeholder:"Enter code",maxLength:4,"aria-label":"Game code input",className:`flex-1 bg-slate-700/50 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:border-cyan-500 focus:outline-none focus:ring-2 focus:ring-cyan-500/20 transition-all duration-300 ${a.length>0&&!l?"border-red-500 focus:border-red-500 focus:ring-red-500/20":l?"border-green-500 focus:border-cyan-500 focus:ring-cyan-500/20":"border-slate-600 focus:border-cyan-500 focus:ring-cyan-500/20"}`}),e.jsx(m,{to:l?`/game/${a}`:"#",end:!0,onClick:w,children:e.jsx("button",{disabled:!l,className:"bg-linear-to-r from-teal-500 to-cyan-600 text-white font-semibold py-3 px-6 rounded-lg hover:from-teal-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-teal-500 disabled:hover:to-cyan-600",children:"Join"})})]})})}),e.jsx("div",{className:"space-y-6",children:e.jsx(m,{to:"/options",end:!0,children:e.jsx("button",{className:"relative border border-slate-800/50 bg-linear-to-r from-slate-600/30 to-slate-700/30 text-white px-6 py-3 rounded-lg font-semibold hover:from-slate-600/50 hover:to-slate-700/50 transition-all",children:e.jsx("div",{className:"relative flex items-center space-x-2",children:e.jsx("span",{children:"Options"})})})})}),!b&&e.jsx("div",{className:"space-y-6",children:e.jsx("button",{onClick:g,className:"relative border border-slate-800/50 bg-linear-to-r from-slate-600/30 to-slate-700/30 text-white px-6 py-3 rounded-lg font-semibold hover:from-slate-600/50 hover:to-slate-700/50 transition-all",children:e.jsx("div",{className:"relative flex items-center space-x-2",children:e.jsx("span",{children:o?"Install App":"Add to Home Screen"})})})})]})})});export{S as clientLoader,T as default};
